.cm-page { max-width: 100%; height: calc(100vh - 40px); }
.cm-layout { display: grid; grid-template-columns: 300px 1fr; height: 100%; border-radius: 12px; overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid var(--border-light); }

/* ── Sidebar ─────────────────────────────────────────────── */
.cm-sidebar { background: var(--bg-card); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; overflow: hidden; }
.cm-sidebar-header { display: flex; align-items: center; justify-content: space-between; padding: 18px 16px 12px; }
.cm-sidebar-title { font-size: 18px; font-weight: 700; color: var(--color-primary); margin: 0; }
.cm-new-btn { width: 34px; height: 34px; border: none; border-radius: 8px; background: var(--btn-primary-bg); color: var(--btn-primary-text); display: flex; align-items: center; justify-content: center; cursor: pointer; }
.cm-new-btn:hover { background: var(--btn-primary-hover); }
.cm-sidebar-tabs { display: flex; gap: 2px; padding: 0 12px 10px; }
.cm-stab { flex: 1; padding: 7px; border: none; border-radius: 6px; background: transparent; font-size: 13px; font-weight: 500; color: var(--color-muted); cursor: pointer; }
.cm-stab.active { background: var(--bg-surface); color: var(--color-primary); }
.cm-list { flex: 1; overflow-y: auto; padding: 0 8px 8px; }
.cm-list-item { display: flex; align-items: center; gap: 10px; width: 100%; padding: 10px 10px; border: none; background: transparent; border-radius: 8px; cursor: pointer; text-align: left; transition: background .15s; }
.cm-list-item:hover { background: var(--bg-surface); }
.cm-list-item.active { background: var(--accent-light); }
.cm-list-icon { width: 36px; height: 36px; border-radius: 8px; background: var(--bg-surface); display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: 700; color: var(--color-primary); flex-shrink: 0; }
.cm-list-info { flex: 1; min-width: 0; }
.cm-list-name { display: block; font-size: 14px; font-weight: 600; color: var(--color-primary); }
.cm-list-desc { display: block; font-size: 12px; color: var(--color-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.cm-list-empty { padding: 20px; text-align: center; font-size: 13px; color: var(--color-muted); }
.cm-unread { min-width: 20px; height: 20px; border-radius: 10px; background: var(--danger); color: #fff; font-size: 11px; font-weight: 700; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.cm-avatar-sm { width: 36px; height: 36px; border-radius: 50%; background: var(--btn-primary-bg); color: var(--btn-primary-text); display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; position: relative; flex-shrink: 0; }
.cm-avatar-md { width: 40px; height: 40px; border-radius: 50%; background: var(--btn-primary-bg); color: var(--btn-primary-text); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; flex-shrink: 0; }
.cm-online-dot { position: absolute; bottom: 0; right: 0; width: 10px; height: 10px; border-radius: 50%; background: #2ecc71; border: 2px solid var(--bg-card); }
.cm-team-search { width: calc(100% - 8px); margin: 0 4px 8px; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; }

/* ── Main chat ───────────────────────────────────────────── */
.cm-main { display: flex; flex-direction: column; background: var(--bg-surface); }
.cm-main-empty { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px; color: var(--color-muted); text-align: center; padding: 24px; }
.cm-main-empty h3 { font-size: 18px; color: var(--color-primary); margin: 0; }
.cm-main-empty p { font-size: 14px; margin: 0; max-width: 300px; }
.cm-chat-header { padding: 14px 20px; background: var(--bg-card); border-bottom: 1px solid var(--border-color); }
.cm-chat-name { font-size: 16px; font-weight: 700; color: var(--color-primary); margin: 0; }
.cm-chat-desc { font-size: 13px; color: var(--color-muted); margin: 2px 0 0; }
.cm-chat-dm-header { display: flex; align-items: center; gap: 12px; }
.cm-messages { flex: 1; overflow-y: auto; padding: 16px 20px; display: flex; flex-direction: column; gap: 8px; }
.cm-messages-empty { flex: 1; display: flex; align-items: center; justify-content: center; color: var(--color-muted); font-size: 14px; }
.cm-msg { max-width: 70%; display: flex; flex-direction: column; }
.cm-msg-me { align-self: flex-end; align-items: flex-end; }
.cm-msg-other { align-self: flex-start; align-items: flex-start; }
.cm-msg-sender { display: flex; gap: 8px; align-items: center; margin-bottom: 2px; }
.cm-msg-name { font-size: 12px; font-weight: 600; color: var(--color-primary); }
.cm-msg-role { font-size: 11px; font-weight: 500; }
.cm-msg-bubble { padding: 10px 14px; border-radius: 14px; font-size: 14px; line-height: 1.5; word-wrap: break-word; white-space: pre-wrap; }
.cm-msg-me .cm-msg-bubble { background: var(--btn-primary-bg); color: var(--btn-primary-text); border-bottom-right-radius: 4px; }
.cm-msg-other .cm-msg-bubble { background: var(--bg-card); color: var(--color-primary); border-bottom-left-radius: 4px; box-shadow: var(--shadow-sm); }
.cm-msg-time { font-size: 11px; color: var(--color-muted); margin-top: 2px; }
.cm-input-area { padding: 12px 16px; background: var(--bg-card); border-top: 1px solid var(--border-color); display: flex; gap: 10px; align-items: flex-end; }
.cm-input { flex: 1; padding: 10px 14px; border: 1px solid var(--border-color); border-radius: 12px; font-size: 14px; resize: none; max-height: 100px; font-family: inherit; }
.cm-input:focus { outline: none; border-color: var(--color-primary); }
.cm-send-btn { width: 40px; height: 40px; border: none; border-radius: 50%; background: var(--btn-primary-bg); color: var(--btn-primary-text); display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; }
.cm-send-btn:hover { background: var(--btn-primary-hover); }
.cm-send-btn:disabled { opacity: .4; cursor: not-allowed; }

/* ── Modal ────────────────────────────────────────────────── */
.cm-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.4); display: flex; align-items: center; justify-content: center; z-index: 9999; }
.cm-modal { background: var(--bg-card); border-radius: 14px; box-shadow: var(--shadow-lg); width: 100%; max-width: 380px; padding: 20px; }
.cm-modal-title { font-size: 17px; font-weight: 600; color: var(--color-primary); margin: 0 0 14px; }
.cm-modal-list { display: flex; flex-direction: column; gap: 4px; max-height: 300px; overflow-y: auto; }
.cm-modal-member { display: flex; align-items: center; gap: 10px; padding: 10px; border: none; background: transparent; border-radius: 8px; cursor: pointer; text-align: left; width: 100%; }
.cm-modal-member:hover { background: var(--bg-surface); }
.cm-modal-name { font-size: 14px; font-weight: 600; color: var(--color-primary); }
.cm-modal-role { font-size: 12px; }
.cm-modal-close { width: 100%; margin-top: 12px; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: transparent; font-size: 14px; cursor: pointer; color: var(--color-secondary); }

@media (max-width: 768px) {
  .cm-layout { grid-template-columns: 1fr; }
  .cm-sidebar { max-height: 280px; border-right: none; border-bottom: 1px solid var(--border-color); }
}

/* ── Dark mode (tokens resolve automatically) ──────────────── */
